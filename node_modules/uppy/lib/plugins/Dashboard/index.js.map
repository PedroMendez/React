{"version":3,"sources":["../../../src/plugins/Dashboard/index.js"],"names":["Plugin","require","Translator","dragDrop","Dashboard","StatusBar","Informer","findDOMElement","prettyBytes","defaultTabIcon","module","exports","core","opts","id","title","type","defaultLocale","strings","selectToUpload","closeModal","upload","importFrom","dashboardWindowTitle","dashboardTitle","copyLinkToClipboardSuccess","copyLinkToClipboardFallback","done","localDisk","myDevice","dropPasteImport","dropPaste","browse","fileProgress","numberOfSelectedFiles","uploadAllNewFiles","defaultOptions","target","getMetaFromForm","trigger","inline","width","height","semiTransparent","showProgressDetails","hideUploadButton","note","closeModalOnClickOutside","locale","translator","containerWidth","translate","bind","hideModal","showModal","addTarget","actions","hideAllPanels","showPanel","initEvents","handleEscapeKeyPress","handleClickOutside","handleFileCard","handleDrop","pauseAll","resumeAll","cancelAll","updateDashboardElWidth","render","install","plugin","callerPluginId","constructor","name","callerPluginName","callerPluginIcon","icon","callerPluginType","msg","log","focus","isHidden","modal","getState","newTargets","targets","slice","push","setState","activePanel","filter","document","body","classList","remove","window","scrollTo","savedDocumentScrollPosition","scrollY","add","style","top","querySelector","setTimeout","event","keyCode","showModalTrigger","addEventListener","removeDragDropListener","el","files","removeEvents","removeEventListener","on","removeActions","off","dashboardEl","offsetWidth","fileId","state","fileCardFor","forEach","file","addFile","source","data","emit","newFiles","Object","keys","progress","uploadStarted","inProgressFiles","uploadComplete","isPaused","inProgressFilesArray","totalSize","totalUploadedSize","bytesTotal","bytesUploaded","acquirers","progressindicators","startUpload","ev","catch","err","stack","message","pauseUpload","fileID","cancelUpload","showFileCard","fileCardDone","meta","info","text","duration","resumableUploads","capabilities","totalFileCount","length","totalProgress","autoProceed","i18n","removeFile","metaFields","maxWidth","maxHeight","currentWidth","isWide","mount","disableStatusBar","use","DashboardUI","disableInformer","uninstall","unmount"],"mappings":"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","file":"index.js","sourcesContent":["const Plugin = require('../Plugin')\nconst Translator = require('../../core/Translator')\nconst dragDrop = require('drag-drop')\nconst Dashboard = require('./Dashboard')\nconst StatusBar = require('../StatusBar')\nconst Informer = require('../Informer')\nconst { findDOMElement } = require('../../core/Utils')\nconst prettyBytes = require('prettier-bytes')\nconst { defaultTabIcon } = require('./icons')\n\n/**\n * Modal Dialog & Dashboard\n */\nmodule.exports = class DashboardUI extends Plugin {\n  constructor (core, opts) {\n    super(core, opts)\n    this.id = 'DashboardUI'\n    this.title = 'Dashboard UI'\n    this.type = 'orchestrator'\n\n    const defaultLocale = {\n      strings: {\n        selectToUpload: 'Select files to upload',\n        closeModal: 'Close Modal',\n        upload: 'Upload',\n        importFrom: 'Import files from',\n        dashboardWindowTitle: 'Uppy Dashboard Window (Press escape to close)',\n        dashboardTitle: 'Uppy Dashboard',\n        copyLinkToClipboardSuccess: 'Link copied to clipboard.',\n        copyLinkToClipboardFallback: 'Copy the URL below',\n        done: 'Done',\n        localDisk: 'Local Disk',\n        myDevice: 'My Device',\n        dropPasteImport: 'Drop files here, paste, import from one of the locations above or',\n        dropPaste: 'Drop files here, paste or',\n        browse: 'browse',\n        fileProgress: 'File progress: upload speed and ETA',\n        numberOfSelectedFiles: 'Number of selected files',\n        uploadAllNewFiles: 'Upload all new files'\n      }\n    }\n\n    // set default options\n    const defaultOptions = {\n      target: 'body',\n      getMetaFromForm: true,\n      trigger: '#uppy-select-files',\n      inline: false,\n      width: 750,\n      height: 550,\n      semiTransparent: false,\n      defaultTabIcon: defaultTabIcon(),\n      showProgressDetails: false,\n      hideUploadButton: false,\n      note: false,\n      closeModalOnClickOutside: false,\n      locale: defaultLocale\n    }\n\n    // merge default options with the ones set by user\n    this.opts = Object.assign({}, defaultOptions, opts)\n\n    this.locale = Object.assign({}, defaultLocale, this.opts.locale)\n    this.locale.strings = Object.assign({}, defaultLocale.strings, this.opts.locale.strings)\n\n    this.translator = new Translator({locale: this.locale})\n    this.containerWidth = this.translator.translate.bind(this.translator)\n\n    this.hideModal = this.hideModal.bind(this)\n    this.showModal = this.showModal.bind(this)\n\n    this.addTarget = this.addTarget.bind(this)\n    this.actions = this.actions.bind(this)\n    this.hideAllPanels = this.hideAllPanels.bind(this)\n    this.showPanel = this.showPanel.bind(this)\n    this.initEvents = this.initEvents.bind(this)\n    this.handleEscapeKeyPress = this.handleEscapeKeyPress.bind(this)\n    this.handleClickOutside = this.handleClickOutside.bind(this)\n    this.handleFileCard = this.handleFileCard.bind(this)\n    this.handleDrop = this.handleDrop.bind(this)\n    this.pauseAll = this.pauseAll.bind(this)\n    this.resumeAll = this.resumeAll.bind(this)\n    this.cancelAll = this.cancelAll.bind(this)\n    this.updateDashboardElWidth = this.updateDashboardElWidth.bind(this)\n    this.render = this.render.bind(this)\n    this.install = this.install.bind(this)\n  }\n\n  addTarget (plugin) {\n    const callerPluginId = plugin.id || plugin.constructor.name\n    const callerPluginName = plugin.title || callerPluginId\n    const callerPluginIcon = plugin.icon || this.opts.defaultTabIcon\n    const callerPluginType = plugin.type\n\n    if (callerPluginType !== 'acquirer' &&\n        callerPluginType !== 'progressindicator' &&\n        callerPluginType !== 'presenter') {\n      let msg = 'Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter'\n      this.core.log(msg)\n      return\n    }\n\n    const target = {\n      id: callerPluginId,\n      name: callerPluginName,\n      icon: callerPluginIcon,\n      type: callerPluginType,\n      focus: plugin.focus,\n      render: plugin.render,\n      isHidden: true\n    }\n\n    const modal = this.core.getState().modal\n    const newTargets = modal.targets.slice()\n    newTargets.push(target)\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        targets: newTargets\n      })\n    })\n\n    return this.target\n  }\n\n  hideAllPanels () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: false\n    })})\n  }\n\n  showPanel (id) {\n    const modal = this.core.getState().modal\n\n    const activePanel = modal.targets.filter((target) => {\n      return target.type === 'acquirer' && target.id === id\n    })[0]\n\n    this.core.setState({modal: Object.assign({}, modal, {\n      activePanel: activePanel\n    })})\n  }\n\n  hideModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: true\n      })\n    })\n\n    document.body.classList.remove('is-UppyDashboard-open')\n\n    window.scrollTo(0, this.savedDocumentScrollPosition)\n  }\n\n  showModal () {\n    const modal = this.core.getState().modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        isHidden: false\n      })\n    })\n\n    // save scroll position\n    this.savedDocumentScrollPosition = window.scrollY\n\n    // add class to body that sets position fixed, move everything back\n    // to scroll position\n    document.body.classList.add('is-UppyDashboard-open')\n    document.body.style.top = `-${this.savedDocumentScrollPosition}px`\n\n    // focus on modal inner block\n    this.target.querySelector('.UppyDashboard-inner').focus()\n\n    // this.updateDashboardElWidth()\n    // to be sure, sometimes when the function runs, container size is still 0\n    setTimeout(this.updateDashboardElWidth, 500)\n  }\n\n  // Close the Modal on esc key press\n  handleEscapeKeyPress (event) {\n    if (event.keyCode === 27) {\n      this.hideModal()\n    }\n  }\n\n  handleClickOutside () {\n    if (this.opts.closeModalOnClickOutside) this.hideModal()\n  }\n\n  initEvents () {\n    // Modal open button\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.addEventListener('click', this.showModal)\n    }\n\n    if (!this.opts.inline && !showModalTrigger) {\n      this.core.log('Dashboard modal trigger not found, you wonâ€™t be able to select files. Make sure `trigger` is set correctly in Dashboard options', 'error')\n    }\n\n    document.body.addEventListener('keyup', this.handleEscapeKeyPress)\n\n    // Drag Drop\n    this.removeDragDropListener = dragDrop(this.el, (files) => {\n      this.handleDrop(files)\n    })\n  }\n\n  removeEvents () {\n    const showModalTrigger = findDOMElement(this.opts.trigger)\n    if (!this.opts.inline && showModalTrigger) {\n      showModalTrigger.removeEventListener('click', this.showModal)\n    }\n\n    this.removeDragDropListener()\n    document.body.removeEventListener('keyup', this.handleEscapeKeyPress)\n  }\n\n  actions () {\n    this.core.on('core:file-added', this.hideAllPanels)\n    this.core.on('dashboard:file-card', this.handleFileCard)\n\n    window.addEventListener('resize', this.updateDashboardElWidth)\n  }\n\n  removeActions () {\n    window.removeEventListener('resize', this.updateDashboardElWidth)\n\n    this.core.off('core:file-added', this.hideAllPanels)\n    this.core.off('dashboard:file-card', this.handleFileCard)\n  }\n\n  updateDashboardElWidth () {\n    const dashboardEl = this.target.querySelector('.UppyDashboard-inner')\n    this.core.log(`Dashboard width: ${dashboardEl.offsetWidth}`)\n\n    const modal = this.core.getState().modal\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        containerWidth: dashboardEl.offsetWidth\n      })\n    })\n  }\n\n  handleFileCard (fileId) {\n    const modal = this.core.state.modal\n\n    this.core.setState({\n      modal: Object.assign({}, modal, {\n        fileCardFor: fileId || false\n      })\n    })\n  }\n\n  handleDrop (files) {\n    this.core.log('All right, someone dropped something...')\n\n    files.forEach((file) => {\n      this.core.addFile({\n        source: this.id,\n        name: file.name,\n        type: file.type,\n        data: file\n      })\n    })\n  }\n\n  cancelAll () {\n    this.core.emit('core:cancel-all')\n  }\n\n  pauseAll () {\n    this.core.emit('core:pause-all')\n  }\n\n  resumeAll () {\n    this.core.emit('core:resume-all')\n  }\n\n  render (state) {\n    const files = state.files\n\n    const newFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadStarted\n    })\n    const inProgressFiles = Object.keys(files).filter((file) => {\n      return !files[file].progress.uploadComplete &&\n             files[file].progress.uploadStarted &&\n             !files[file].isPaused\n    })\n\n    let inProgressFilesArray = []\n    inProgressFiles.forEach((file) => {\n      inProgressFilesArray.push(files[file])\n    })\n\n    // total size and uploaded size\n    let totalSize = 0\n    let totalUploadedSize = 0\n    inProgressFilesArray.forEach((file) => {\n      totalSize = totalSize + (file.progress.bytesTotal || 0)\n      totalUploadedSize = totalUploadedSize + (file.progress.bytesUploaded || 0)\n    })\n    totalSize = prettyBytes(totalSize)\n    totalUploadedSize = prettyBytes(totalUploadedSize)\n\n    const acquirers = state.modal.targets.filter((target) => {\n      return target.type === 'acquirer'\n    })\n\n    const progressindicators = state.modal.targets.filter((target) => {\n      return target.type === 'progressindicator'\n    })\n\n    const startUpload = (ev) => {\n      this.core.upload().catch((err) => {\n        // Log error.\n        this.core.log(err.stack || err.message || err)\n      })\n    }\n\n    const pauseUpload = (fileID) => {\n      this.core.emit.emit('core:upload-pause', fileID)\n    }\n\n    const cancelUpload = (fileID) => {\n      this.core.emit('core:upload-cancel', fileID)\n      this.core.emit('core:file-remove', fileID)\n    }\n\n    const showFileCard = (fileID) => {\n      this.core.emit('dashboard:file-card', fileID)\n    }\n\n    const fileCardDone = (meta, fileID) => {\n      this.core.emit('core:update-meta', meta, fileID)\n      this.core.emit('dashboard:file-card')\n    }\n\n    const info = (text, type, duration) => {\n      this.core.info(text, type, duration)\n    }\n\n    const resumableUploads = this.core.state.capabilities.resumableUploads || false\n\n    return Dashboard({\n      state: state,\n      modal: state.modal,\n      newFiles: newFiles,\n      files: files,\n      totalFileCount: Object.keys(files).length,\n      totalProgress: state.totalProgress,\n      acquirers: acquirers,\n      activePanel: state.modal.activePanel,\n      progressindicators: progressindicators,\n      autoProceed: this.core.opts.autoProceed,\n      hideUploadButton: this.opts.hideUploadButton,\n      id: this.id,\n      hideModal: this.hideModal,\n      handleClickOutside: this.handleClickOutside,\n      showProgressDetails: this.opts.showProgressDetails,\n      inline: this.opts.inline,\n      semiTransparent: this.opts.semiTransparent,\n      showPanel: this.showPanel,\n      hideAllPanels: this.hideAllPanels,\n      log: this.core.log,\n      i18n: this.containerWidth,\n      pauseAll: this.pauseAll,\n      resumeAll: this.resumeAll,\n      addFile: this.core.addFile,\n      removeFile: this.core.removeFile,\n      info: info,\n      note: this.opts.note,\n      metaFields: state.metaFields,\n      resumableUploads: resumableUploads,\n      startUpload: startUpload,\n      pauseUpload: pauseUpload,\n      cancelUpload: cancelUpload,\n      fileCardFor: state.modal.fileCardFor,\n      showFileCard: showFileCard,\n      fileCardDone: fileCardDone,\n      updateDashboardElWidth: this.updateDashboardElWidth,\n      maxWidth: this.opts.maxWidth,\n      maxHeight: this.opts.maxHeight,\n      currentWidth: state.modal.containerWidth,\n      isWide: state.modal.containerWidth > 400\n    })\n  }\n\n  install () {\n    // Set default state for Modal\n    this.core.setState({modal: {\n      isHidden: true,\n      showFileCard: false,\n      activePanel: false,\n      targets: []\n    }})\n\n    const target = this.opts.target\n    const plugin = this\n    this.target = this.mount(target, plugin)\n\n    if (!this.opts.disableStatusBar) {\n      this.core.use(StatusBar, {\n        target: DashboardUI\n      })\n    }\n\n    if (!this.opts.disableInformer) {\n      this.core.use(Informer, {\n        target: DashboardUI\n      })\n    }\n\n    this.initEvents()\n    this.actions()\n  }\n\n  uninstall () {\n    this.unmount()\n    this.removeActions()\n    this.removeEvents()\n  }\n}\n"]}